---
output:
  html_document: default
  word_document: default
editor_options:
  chunk_output_type: console
---

```{r setup-2, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
	warning = FALSE,
  embed_fonts = TRUE,
  fig.fullwidth = TRUE,
  fig.align = "center",
  use_bookdown= TRUE,
  toc= TRUE,
  toc_depth= 4
)
```

```{r libraries-2, include=FALSE}

#### packages needed
if(!require(tidyverse)) install.packages("tidyverse", repos = "http://cran.us.r-project.org")
if(!require(gridExtra)) install.packages("girdExtra", repos = "http://cran.us.r-project.org")
if(!require(Hmisc)) install.packages("Hmisc", repos = "http://cran.us.r-project.org")
if(!require(sjlabelled)) install.packages("sjlabelled", repos = "http://cran.us.r-project.org")
if(!require(ggthemes)) install.packages("ggthemes", repos = "http://cran.us.r-project.org")
if(!require(ggtext)) install.packages("ggtext", repos = "http://cran.us.r-project.org")
if(!require(ggrepel)) install.packages("ggrepel", repos = "http://cran.us.r-project.org")
if(!require(doBy)) install.packages("doBy", repos = "http://cran.us.r-project.org")
if(!require(sjmisc)) install.packages("sjmisc", repos = "http://cran.us.r-project.org")
if(!require(webshot)) install.packages("webshot", repos = "http://cran.us.r-project.org")
if(!require(scales)) install.packages("scales", repos = "http://cran.us.r-project.org")
if(!require(ggalt)) install.packages("ggalt", repos = "http://cran.us.r-project.org")
if(!require(janitor)) install.packages("janitor", repos = "http://cran.us.r-project.org")
if(!require(bookdown)) install.packages("bookdown", repos = "http://cran.us.r-project.org")
if(!require(htmlwidgets)) install.packages("htmlwidgets", repos = "http://cran.us.r-project.org")
if(!require(widgetframe)) install.packages("widgetframe", repos = "http://cran.us.r-project.org")
if(!require(officer)) install.packages("officer", repos = "http://cran.us.r-project.org")
if(!require(showtext)) install.packages("showtext", repos = "http://cran.us.r-project.org")
if(!require(colorspace)) install.packages("colorspace", repos = "http://cran.us.r-project.org")
if(!require(patchwork)) install.packages("patchwork", repos = "http://cran.us.r-project.org")
if(!require(ggpubr)) install.packages("ggpubr", repos = "http://cran.us.r-project.org")
if(!require(gt)) install.packages("gt", repos = "http://cran.us.r-project.org")
if(!require(htmltools)) install.packages("htmltools", repos = "http://cran.us.r-project.org")
if(!require(yaml)) install.packages("yaml", repos = "http://cran.us.r-project.org")
if(!require(grid)) install.packages("grid", repos = "http://cran.us.r-project.org")
if(!require(see)) install.packages("see", repos = "http://cran.us.r-project.org")

library(see) # colorblind-friendly ‘Okabe-Ito’ palette
library(ggalt) # contingency table
library(tidyverse) # several tools for data manipulation
library(haven) # read SPSS, Stata, and SAS data
library(gridExtra) # arrange multiple grid-based plots on a page
library(Hmisc) # many functions useful for data analysis
library(sjmisc) # useful to set Na's
library(sjlabelled) # get_labels function
library(ggthemes) # themes for ggplot2
library(ggtext) # fancy text
library(ggrepel) # help with the position of the labels on ggplot2 graph
library(doBy) # 'do' something to data stratified 'by' some variables
library(scales) # add scale symbols and colour to axis
library(janitor) # add totals to tables
library(bookdown) # add totals to tables
library(htmlwidgets)
library(widgetframe)
library(colorspace) # colour blind friendly pallettes 
library(officer) # to add additional formatting to tables 
library(patchwork) # to put graphs side by side
library(ggpubr) # easy-to-use functions for creating and customizing ‘ggplot2’- based publication ready plots.
library(gt) #  creation of interactive data tables
library(htmltools) # tools for creating, manipulating, and writing HTML 
library(grid)
library(webshot)
library(yaml)
library(showtext)
  font_add_google("Lato")
  showtext_auto()

```

```{r load-data-2, include=FALSE}

load("../../data/LFS_clean.rda")

LFS_clean_skills <- LFS_clean %>% 
  filter(sequence != 65) %>%  
  mutate(sequence2 = case_when(
  sequence == 66 ~ 65,
  sequence == 67 ~ 66,
  sequence == 68 ~ 67,
  TRUE ~ sequence
))

```


```{r copyright-2, include=FALSE}

# top left
copyright = grobTree(textGrob("(c) The Underemployment Project\n      underemployment.info", x=0.008, y= 0.94, hjust=0, gp=gpar(col="gray40", fontsize=8, lineheight = .6, fill="white", alpha = 1))) 

# top right
copyright2 = grobTree(textGrob("(c) The Underemployment Project\n      underemployment.info", x=0.99, y= 0.94, hjust=1, gp=gpar(col="gray40", fontsize=8, lineheight = .6, fill="white", alpha = 1))) 

# bottom left 
copyright3 = grobTree(textGrob("(c) The Underemployment Project\n      underemployment.info", x=0.008, y= 0.05, hjust=0, gp=gpar(col="gray40", fontsize=8, lineheight = .6, fill="white", alpha = 1))) 

```


# Skills-related underemployment

<p align="justify">Our second dimension of underemployment is skills-related underemployment. We examine levels and trends over time in the number of workers who have skills that are greater than those required in their current job. We measure skills-related underemployment via one indicator we construct as follows:</p>

- <p align="justify">Using education level data, we first group employees into those who have High, Intermediate and Low skill levels.</p>
- <p align="justify">We group occupations into three skill levels: those that demand High, Intermediate and Low skills.</p>
- <p align="justify">We consider employees as being skills-related underemployed when their education level is higher than the skill level required in their current occupation.</p> 

(See [Technical Appendix 3: Skills-related underemployment] for full details).


## Skills-related underemployment by sex

<p align="justify"> Figure \@ref(fig:plot-overqualified-employees-sex) shows that the proportion of individuals categorised as underemployed in terms of their skills steadily increased between 2006 and 2022. Skills related underemployment considerably increased since 2006. The number of overqualified employees increased from over 1.5 million in 2006, to over 3.7 million in 2022. From 2006 to 2008 the percentage of overqualified male and female workers was similar, however since 2009 the gap between women and men has widened.</p>

<p align="justify"> In the quarter from January to March 2022 the LFS questionnaire had changes related to education variables. This implies that values from previous waves were not brought forward to this period [@ONS2022b]. Therefore, we have removed the quarter from January to March 2022 in this section.</p>


```{r overqualification-by-men-and-women-table, include=FALSE}

options(digits = 3)

n_skills <- LFS_clean_skills %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  group_by(year, sequence2, quarter, SEX, sk_mm) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence2, quarter, SEX) %>% 
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(sk_mm == 1) %>%  #filtering by overqualified
  as_label(.)

```


```{r plot-overqualified-employees-sex, fig.width = 7.5, fig.asp = 0.7, out.width = '100%', fig.cap= "Workers with qualifications exceeding the requirements for their occupation"}

p_nskills <- n_skills %>% 
  ggplot(aes(x = sequence2, y = percentage, colour = factor(SEX))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  #scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_colour_okabeito(palette = "full") + 
  scale_y_continuous(breaks = seq(0,0.3, 0.05), limits = c(0, 0.3), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:67), position = "top",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "","", 
                              "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", 
                            "", "2016", "", "", "", "2017", "", "", "", "2018", "", "", 
                            "", "2019", "", "", "", "2020", "", "", "", "2021", "", "", "", "2022",""), 
                     expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="Figure 1. Overqualified workers by gender (percentages and totals)",
       subtitle  = "",
       caption = ""
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.3, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 9, y = 0.25, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.3, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 30, y = 0.25, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .6) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.3, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 55, y = 0.25, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .6) +
  annotate('rect', xmin=63, xmax=67, ymin=0, ymax=0.3, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 62, y = 0.25, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .6) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0.5, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 0, margin = ggplot2::margin(0, 0, 0, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(4, 0, 5, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "none", 
        legend.title = element_blank(),
        legend.text = element_text(size = 14),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 5)))

pskills_total <- n_skills %>% 
  ggplot(aes(x = sequence2, y = count, fill = factor(SEX))) + 
  geom_bar(stat = "identity", position = "dodge", width=0.8) +   
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  #scale_fill_discrete_qualitative(palette = "Dark 3") +
  scale_fill_okabeito(palette = "full") + 
  scale_y_continuous(breaks = seq(0,3000000, 250000), limits = c(0,3000000), labels = comma, expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:67),
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "","", 
                              "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", 
                            "", "2016", "", "", "", "2017", "", "", "", "2018", "", "", 
                            "", "2019", "", "", "", "2020", "", "", "", "2021", "", "", "", "2022", ""), 
                     expand = c(0,0)) +

  
  # annotation
  labs(x = "Year", 
       y = "Total", 
       #title = "",
       #subtitle  = "Totals based on people in employment between 2006 and 2022",
       #caption = c("Note: People in employment (employees and self-employed) between 2006 and 2022")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=3000000, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 9, y = 2300000, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=3000000, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 30, y = 2300000, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=3000000, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 55, y = 2300000, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=67, ymin=0, ymax=3000000, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 62, y = 2300000, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 0, margin = ggplot2::margin(0, 0, 0, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 0, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 14),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 5)))

p_nskills / pskills_total


```


## Skills-related underemployment by age group

<p align="justify">Figure \@ref(fig:plot-overqualified-employees-age) shows that the younger the worker, the more likely they are to be overqualified in their current jobs. The age group between 18 to 24 years old has a particularly higher proportion of workers holding a qualification above the one required at their jobs.</p>  

```{r overqualification-by-age-table, include=FALSE}

options(digits = 3)

n_skills_age <- LFS_clean_skills %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  #creating age categories
  mutate(AGE_cat = case_when(AGE %in% 18:24 ~ "Between 18 and 24",
                             AGE %in% 25:34 ~ "Between 25 and 34",
                             AGE %in% 35:44 ~ "Between 35 and 44",
                             AGE %in% 45:54 ~ "Between 45 and 54",
                             AGE %in% 55:64 ~ "Between 55 and 64",
                             is.na(AGE) ~ NA)) %>%
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  group_by(year, sequence2, quarter, AGE_cat, sk_mm) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence2, quarter, AGE_cat) %>% 
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(sk_mm == 1) %>%  #filtering by overqualified
  as_label(.)

```

```{r plot-overqualified-employees-age, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Younger workers are more likely to be overqualified in their jobs"}

p_nskills_age <- n_skills_age %>% 
  ggplot(aes(x = sequence2, y = percentage, colour = factor(AGE_cat))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  #scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_colour_okabeito(palette = "full") + 
  scale_y_continuous(breaks = seq(0,0.5, 0.05), limits = c(0, 0.5), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:67), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "","", 
                              "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", 
                            "", "2016", "", "", "", "2017", "", "", "", "2018", "", "", 
                            "", "2019", "", "", "", "2020", "", "", "", "2021", "", "", "", "2022",""), 
                     expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="Figure 2. Overqualified workers by age (percentages and totals)",
       #subtitle  = "",
       #caption = ""
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.5, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.40, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.5, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.40, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 55, y = 0.40, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=67, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 62, y = 0.40, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0.5, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_nskills_age

```


## Skills-related underemployment by ethnic group

<p align="justify">Figure \@ref(fig:plot-overqualified-employees-eth) shows workers from ethnic-minority groups are more likely to find themselves in jobs for which they are overqualified than are white workers. Furthermore, after the great recession underemployment grew among ethnic-minority groups: the percentage overqualified increased and then remained steady at a higher level. Underemployment among white workers rose steadily from 2010.</p>


```{r overqualification-by-ethnicity-table, include=FALSE}

LFS_clean_skills <- LFS_clean_skills %>% mutate(ETH2 = case_match(ETH, 
                                        1 ~ "White",
                                        2 ~ "Minority-ethnic", 
                                        3 ~ "Minority-ethnic", 
                                        4 ~ "Minority-ethnic", 
                                        5 ~ "Minority-ethnic",
                                        6 ~ "Minority-ethnic")) %>% 
                                    as_numeric(., keep.labels = TRUE)

options(digits = 3)

n_skills_eth <- LFS_clean_skills %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  group_by(year, sequence2, quarter, ETH2, sk_mm) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence2, quarter, ETH2) %>% 
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(sk_mm == 1) %>%  #filtering by overqualified
  filter(!is.na(ETH2)) %>%  # remove NAs from the ethnicity variable
  as_label(.)

```


```{r plot-overqualified-employees-eth, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Ethnic-minority groups are more likely to find themselves in jobs for which they are overqualified"}

p_nskills_eth <- n_skills_eth %>% 
  ggplot(aes(x = sequence2, y = percentage, colour = factor(ETH2))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  #scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_colour_okabeito(palette = "full") + 
  scale_y_continuous(breaks = seq(0,0.5,0.05), limits = c(0, 0.5), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:67), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "","", 
                              "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", 
                            "", "2016", "", "", "", "2017", "", "", "", "2018", "", "", 
                            "", "2019", "", "", "", "2020", "", "", "", "2021", "", "", "", "2022",""), 
                     expand = c(0,0)) +
  # annotation
  labs(x = " ", 
       y = "Percentage", 
       #title ="Figure 3. Overqualified workers by ethnic groups (percentages and totals)",
       #subtitle  = "",
       #caption = ""
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.50, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.35, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.50, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.35, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.50, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 55, y = 0.35, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=67, ymin=0, ymax=0.50, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 62, y = 0.35, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0.5, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06),
        legend.spacing = unit(0.2, 'cm')) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_nskills_eth

```


## Skills-related underemployment by qualification level

<p align="justify">Workers with a degree or equivalent level of education are substantially more likely to be overqualified for their current job than are other workers (Figure \@ref(fig:plot-overqualified-employees-by-education)). Their underemployment grew after the great recession and it has not returned to pre-2008 levels. The percentage of overqualified workers among those with a “Higher education” and “GCE, A-level or equivalent” did not change in the period under study.</p>

```{r overqualification-by-educational-level-table, include=FALSE}

options(digits = 3)

n_skills_quali <- LFS_clean_skills %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  group_by(year, sequence2, quarter, quali, sk_mm) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence2, quarter, quali) %>% 
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(quali) & !quali %in% c("7")) %>% 
  filter(sk_mm == 1) %>%  #filtering by overqualified
  as_label(.)

```


```{r plot-overqualified-employees-by-education, fig.width = 7.5, fig.asp = 0.6, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Workers with a university degree are more likely to be overqualified for their jobs"}

p_nskills_quali <- n_skills_quali %>% 
  ggplot(aes(x = sequence2, y = percentage, colour = factor(quali))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  #scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_colour_okabeito(palette = "full") + 
  scale_y_continuous(breaks = seq(0,0.5,0.05), limits = c(0, 0.5), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:67), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "","", 
                              "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", 
                            "", "2016", "", "", "", "2017", "", "", "", "2018", "", "", 
                            "", "2019", "", "", "", "2020", "", "", "", "2021", "", "", "", "2022",""), 
                     expand = c(0,0)) +
  # annotation
  labs(x = " ", 
       y = "Percentage", 
       #title =",
       #subtitle  = "",
       #caption = ""
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.50, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.35, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.50, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.35, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.50, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 55, y = 0.35, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=67, ymin=0, ymax=0.50, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 62, y = 0.35, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0.5, 0.2, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        #panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06),
        legend.spacing = unit(0.2, 'cm')) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_nskills_quali



```

## Skills-related underemployment by occupational group

<p align="justify">Figure \@ref(fig:plot-overqualified-employees-nsec) shows that the female-dominated ‘intermediate’ occupational group (covering such occupations as secretary, personal assistant, clerical worker, office clerk, call centre agent, nursing auxiliary or nursery nurse) have a larger proportion of overqualified employees than do other occupations. Between 2006 and 2022, all occupations saw an increase in skills-related underemployment. The exception here is managers/professionals among whom skills-related underemployment is negligible. </p>

```{r overqualification-by-occupational-category-table, include=FALSE}

options(digits = 3)

n_skills_nsec <- LFS_clean_skills %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  group_by(year, sequence2, quarter, NSEC2,sk_mm) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence2, quarter, NSEC2) %>% 
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(NSEC2) & !NSEC2 %in% c(3,6)) %>%  # omit no answers and no apply
  filter(sk_mm == 1) %>%  #filtering by overqualified
  as_label(.)

```

```{r plot-overqualified-employees-nsec, fig.width = 7.5, fig.asp = 0.6, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Intermediate occupations have the largest proportion of overqualified employees"}

p_nskills_nsec <- n_skills_nsec %>% 
  ggplot(aes(x = sequence2, y = percentage, colour = factor(NSEC2))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  #scale_color_discrete_qualitative(palette = "Dynamic") +
  scale_colour_okabeito(palette = "full") + 
  scale_y_continuous(breaks = seq(0,0.5,0.05), limits = c(0, 0.5), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:67), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "","", 
                              "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", 
                            "", "2016", "", "", "", "2017", "", "", "", "2018", "", "", 
                            "", "2019", "", "", "", "2020", "", "", "", "2021", "", "", "", "2022",""), 
                     expand = c(0,0)) +
  # annotation
  labs(x = "Year", 
       y = "Percentage", 
       #title ="Figure 5. Overqualified workers by occupational category (percentages and totals)",
       #subtitle  = "",
      #caption = ""
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.5, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.40, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.5, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.40, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 55, y = 0.40, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=67, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 62, y = 0.40, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0.5, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_nskills_nsec

```

##  Skills-related underemployment by contract type 

<p align="justify">As Figure \@ref(fig:plot-overqualified-employees-JOBTYP) shows, workers in a non-permanent job are more likely to be over-qualified for their jobs than are permanent workers. The proportion of overqualified workers increased over time for both groups.</p>   

```{r overqualification-by-work-arrangement-table, include=FALSE}

options(digits = 3)

t_skills_temp <- LFS_clean_skills %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  group_by(year, sequence2, quarter, JOBTYP,sk_mm) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence2, quarter, JOBTYP) %>% 
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(JOBTYP)) %>%  # omit no answers and no apply
  filter(sk_mm == 1) %>%  #filtering by overqualified
  as_label(.)

```


```{r plot-overqualified-employees-JOBTYP, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Workers in non-permanent jobs likely to be overqualified"}

p_nskills_temp <- t_skills_temp %>% 
  ggplot(aes(x = sequence2, y = percentage, colour = factor(JOBTYP))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  #scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_colour_okabeito(palette = "full") + 
  scale_y_continuous(breaks = seq(0,0.5,0.05), limits = c(0, 0.5), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:67), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "","", 
                              "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", 
                            "", "2016", "", "", "", "2017", "", "", "", "2018", "", "", 
                            "", "2019", "", "", "", "2020", "", "", "", "2021", "", "", "", "2022",""), 
                     expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="Figure 6. Overqualified workers by work arrangement (percentages and totals)",
       #subtitle  = "",
       #caption = ""
       ) +

  # theme
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.5, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.40, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.5, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.40, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 55, y = 0.40, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=67, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 62, y = 0.40, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0.5, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_nskills_temp

```


<p align="justify">In times of economic unrest, more employees might enter into jobs that require lower qualifications than they possess and they might accept more precarious working arrangements to avoid unemployment. As Figure \@ref(fig:plot-overqualified-fled) shows, this can be observed in the increase in flexible employment arrangements over time. The proportion of overqualified workers with zero-hours contracts in particular increased substantially during the cost-of-living crisis.</p>

```{r overqualified-table-fled, include=FALSE}

# 7 "On call working" is not presente before 2010

# "Flexi-time" = 1,
# "Annualised hours contract" = 2,
# "Term-time working" = 3,
# "Job sharing" = 4,
# "Condensed or compressed hours" = 5,
# "Zero hours contract" = 6, 
# "On call working" = 7,
# "None of these" = 8

options(digits = 3)

t_nskills_fled <- LFS_clean_skills %>% # summary table
  filter(!sequence %in% c(1, 3, 5, 7, 9, 13, 17, 19, 21, 23, 
                        25, 27, 31, 33, 35, 37, 39, 41, 43,
                        45, 47, 49, 51, 53, 55)) %>%
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(FTPTWK == 2) %>% # only part-timers
  group_by(year, sequence2, quarter, FLED, sk_mm) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence2, quarter, FLED) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(FLED) & !FLED %in% c(5, 7, 8)) %>%  # omit compressed, none, and on call
  filter(sk_mm == 1) %>%  #filtering by overqualified
  as_label(.)

```

```{r plot-overqualified-fled, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Zero-hours workers are more likely to be overqualified"}

p_nskills_fled <- t_nskills_fled %>% 
  ggplot(aes(x = sequence2, y = percentage, colour = factor(FLED))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  #scale_color_discrete_qualitative(palette = "Dynamic") +
  scale_colour_okabeito(palette = "full") + 
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:67), 
                     labels=c("","","2006","",
                              "","2007","","",
                              "","2008","","",
                              "","2009","","",
                              "","2010","","",
                              "","2011","","",
                              "","2012","","",
                              "","2013","","",
                              "","2014","","",
                              "","2015","","",
                              "","2016","","",
                              "","2017","","",
                              "","2018","","",
                              "","2019","","",
                              "","2020","","",
                              "","2021","","",
                              "","2022",""),
                     expand = c(0,0)) +

   # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Could not find a full-time job as a percentage of part-time workers in the category")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.80, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.80, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 55, y = 0.80, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=67, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 62, y = 0.80, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0.5, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_nskills_fled

```


## Skills-related underemployment by region

<p align="justify">Figure \@ref(fig:plot-skills-by-region) shows that the mismatch between the skills held by workers and the requirements of their jobs increased steadily in all regions. Scotland (including Glasgow) shows a slightly higher proportion of overqualified workers in most periods between 2006 and 2022 while the East Midlands (including Nottingham) currently has one of the lowest levels of skills-related underemployment in the UK, but the regional gap is narrow.</p>   


```{r overqualification-by-region-table, include=FALSE}

LFS_clean_skills <- LFS_clean_skills %>% mutate(GOVTOF3 = case_match(GOVTOF2, 
                                            1 ~ "Rest of England",
                                            2 ~ "North West", 
                                            4 ~ "Rest of England",
                                            5 ~ "East Midlands", 
                                            6 ~ "Rest of England", 
                                            7 ~ "Rest of England",
                                            8 ~ "Rest of England", 
                                            9 ~ "Rest of England",
                                            10 ~ "South West",
                                            11 ~ "Wales",
                                            12 ~ "Scotland",
                                            13 ~ "Northern Ireland")) %>% 
                                                as_numeric(., keep.labels = TRUE)

LFS_clean_skills$GOVTOF3 <- set_labels(LFS_clean_skills$GOVTOF3, labels = c(
                                                      "East Midlands (incl. Nottingham)" = 1,
                                                      "North West (incl. Salford)" = 2, 
                                                      "Northern Ireland" = 3,
                                                      "Rest of England" = 4, 
                                                      "Scotland (incl. Glasgow)" = 5, 
                                                      "South West (incl. Bristol)" = 6,
                                                      "Wales" = 7))


options(digits = 3)

t_skills_region <- LFS_clean_skills %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  group_by(year, sequence2, quarter, GOVTOF3, sk_mm) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence2, quarter, GOVTOF3) %>% 
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(GOVTOF3)) %>%  # omit no answers and no apply
  filter(sk_mm == 1) %>%  #filtering by overqualified
  as_label(.)

```


```{r plot-skills-by-region, fig.width = 7.5, fig.asp = 0.6, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "The mismatch between skills and job requirements has increased steadily in all regions"}


p_nskills_region <- t_skills_region %>% 
  ggplot(aes(x = sequence2, y = percentage, colour = factor(GOVTOF3))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  #scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_colour_okabeito(palette = "full") + 
  scale_y_continuous(breaks = seq(0,0.5,0.05), limits = c(0, 0.5), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:67), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "","", 
                              "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", 
                            "", "2016", "", "", "", "2017", "", "", "", "2018", "", "", 
                            "", "2019", "", "", "", "2020", "", "", "", "2021", "", "", "", "2022",""), 
                     expand = c(0,0)) +
  # annotation
  labs(x = " ", 
       y = "Percentage", 
       #title ="Figure 3. Overqualified workers by ethnic groups (percentages and totals)",
       #subtitle  = "",
       #caption = ""
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.50, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.35, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.50, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.35, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.50, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 55, y = 0.35, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=67, ymin=0, ymax=0.50, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 62, y = 0.35, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0.5, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06),
        legend.spacing = unit(0.2, 'cm')) +
  guides(col = guide_legend(nrow = 2, byrow = TRUE, override.aes = list(size = 6)))

p_nskills_region

```


## Skills-related underemployment by industry

<p align="justify">Hospitality (accommodation and food service activities) stands out as the sector with most skills-related underemployment and the highest growth over time (Figure \@ref(fig:plot-overqualification-ind1)). The proportion of overqualified employees steadily increased in the six industries related to the provision of services.</p>

```{r overqualification-by-industry-sector-table, include=FALSE}

options(digits = 3)

t_skills_ind1 <- LFS_clean_skills %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  group_by(year, sequence2, quarter, ind1,sk_mm) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence2, quarter, ind1) %>% 
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(ind1) & ind1 %in% c(7, 17, 11, 16, 10, 9)) %>%  # omit no answers and no apply
  filter(sk_mm == 1) %>%  #filtering by overqualified
  as_label(.)

```


```{r plot-overqualification-ind1, fig.width = 7.5, fig.asp = 0.6, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Skills-related underemployment is concentrated in the Retail and Hospitality sectors"}

p_skills_ind1 <- t_skills_ind1 %>% 
  ggplot(aes(x = sequence2, y = percentage, colour = factor(ind1))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  #scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_colour_okabeito(palette = "full") + 
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:67), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "","", 
                              "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", 
                            "", "2016", "", "", "", "2017", "", "", "", "2018", "", "", 
                            "", "2019", "", "", "", "2020", "", "", "", "2021", "", "", "", "2022",""), 
                     expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Could not find a full-time job as a percentage of part-time workers in the category")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.80, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.80, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 55, y = 0.80, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=67, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 62, y = 0.80, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0.5, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 3, byrow = TRUE, override.aes = list(size = 5)))

p_skills_ind1

```


## Summary: Skills-related underemployment

<p align="justify">The skills-related underemployed are workers who possess higher levels of skills than their current job requires. Younger workers, minority ethnic workers, precarious workers, those with degrees, and people employed in intermediate occupations or in hospitality, alongside slightly more women than men, were more likely to have skills greater than their jobs needs. We next discuss wage-related underemployment.</p>

