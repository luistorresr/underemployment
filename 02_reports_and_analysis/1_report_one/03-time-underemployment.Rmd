
```{r setup-1, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
	warning = FALSE,
  embed_fonts = TRUE,
  fig.fullwidth = TRUE,
  fig.align = "center",
  use_bookdown= TRUE,
  toc= TRUE,
  toc_depth= 4
)
```

```{r libraries-1, include=FALSE}

#### packages needed
if(!require(tidyverse)) install.packages("tidyverse", repos = "http://cran.us.r-project.org")
if(!require(gridExtra)) install.packages("girdExtra", repos = "http://cran.us.r-project.org")
if(!require(Hmisc)) install.packages("Hmisc", repos = "http://cran.us.r-project.org")
if(!require(sjlabelled)) install.packages("sjlabelled", repos = "http://cran.us.r-project.org")
if(!require(ggthemes)) install.packages("ggthemes", repos = "http://cran.us.r-project.org")
if(!require(ggtext)) install.packages("ggtext", repos = "http://cran.us.r-project.org")
if(!require(ggrepel)) install.packages("ggrepel", repos = "http://cran.us.r-project.org")
if(!require(doBy)) install.packages("doBy", repos = "http://cran.us.r-project.org")
if(!require(sjmisc)) install.packages("sjmisc", repos = "http://cran.us.r-project.org")
if(!require(webshot)) install.packages("webshot", repos = "http://cran.us.r-project.org")
if(!require(scales)) install.packages("scales", repos = "http://cran.us.r-project.org")
if(!require(ggalt)) install.packages("ggalt", repos = "http://cran.us.r-project.org")
if(!require(janitor)) install.packages("janitor", repos = "http://cran.us.r-project.org")
if(!require(bookdown)) install.packages("bookdown", repos = "http://cran.us.r-project.org")
if(!require(htmlwidgets)) install.packages("htmlwidgets", repos = "http://cran.us.r-project.org")
if(!require(widgetframe)) install.packages("widgetframe", repos = "http://cran.us.r-project.org")
if(!require(officer)) install.packages("officer", repos = "http://cran.us.r-project.org")
if(!require(showtext)) install.packages("showtext", repos = "http://cran.us.r-project.org")
if(!require(colorspace)) install.packages("colorspace", repos = "http://cran.us.r-project.org")
if(!require(patchwork)) install.packages("patchwork", repos = "http://cran.us.r-project.org")
if(!require(ggpubr)) install.packages("ggpubr", repos = "http://cran.us.r-project.org")
if(!require(gt)) install.packages("gt", repos = "http://cran.us.r-project.org")
if(!require(htmltools)) install.packages("htmltools", repos = "http://cran.us.r-project.org")
if(!require(yaml)) install.packages("yaml", repos = "http://cran.us.r-project.org")
if(!require(grid)) install.packages("grid", repos = "http://cran.us.r-project.org")

library(ggalt) # contingency table
library(tidyverse) # several tools for data manipulation
library(haven) # read SPSS, Stata, and SAS data
library(gridExtra) # arrange multiple grid-based plots on a page
library(Hmisc) # many functions useful for data analysis
library(sjmisc) # useful to set Na's
library(sjlabelled) # get_labels function
library(ggthemes) # themes for ggplot2
library(ggtext) # fancy text
library(ggrepel) # help with the position of the labels on ggplot2 graph
library(doBy) # 'do' something to data stratified 'by' some variables
library(scales) # add scale symbols and colour to axis
library(janitor) # add totals to tables
library(bookdown) # add totals to tables
library(htmlwidgets)
library(widgetframe)
library(colorspace) # colour blind friendly pallettes 
library(officer) # to add additional formatting to tables 
library(patchwork) # to put graphs side by side
library(ggpubr) # easy-to-use functions for creating and customizing ‘ggplot2’- based publication ready plots.
library(gt) #  creation of interactive data tables
library(htmltools) # tools for creating, manipulating, and writing HTML 
library(grid)
library(webshot)
library(yaml)
library(showtext)
  font_add_google("Lato")
  showtext_auto()

```

```{r load-data-1, include=FALSE}

load("../../data/LFS_clean.rda")

```

```{r copyright-1, include=FALSE}

# top left
copyright = grobTree(textGrob("(c) The Underemployment Project\n      underemployment.info", x=0.008, y= 0.94, hjust=0, gp=gpar(col="gray40", fontsize=8, lineheight = .6, fill="white", alpha = 1))) 

# top right
copyright2 = grobTree(textGrob("(c) The Underemployment Project\n      underemployment.info", x=0.99, y= 0.94, hjust=1, gp=gpar(col="gray40", fontsize=8, lineheight = .6, fill="white", alpha = 1))) 

# bottom left 
copyright3 = grobTree(textGrob("(c) The Underemployment Project\n      underemployment.info", x=0.008, y= 0.05, hjust=0, gp=gpar(col="gray40", fontsize=8, lineheight = .6, fill="white", alpha = 1))) 

```


# Time-related underemployment

<p align="justify">Time-related underemployment is broadly defined  as a situation where people are working fewer hours than they wish [@Wang2018; @Bell2013]. This has often been measured in terms of the number of people who could not find a full-time job: people involuntarily working part-time hours. However, measuring underemployment in this way does not consider the actual number of hours currently worked or the actual number of additional hours desired, and it fails to recognise that full-time workers may also want additional hours. The International Labour Organisation [@ILO2013] improves upon this definition by considering as underemployed those wanting to work more hours, are available to do so, and are currently working a number of hours below a specified threshold. The Office of National Statistics [@ONS2022] in the UK operationalises this by considered as underemployed those who:</p>
-	<p align="justify">are looking for an additional job or replacement job with longer hours, or who wanted to work longer hours in their current (main) job.</p>
-	<p align="justify">were available to start working longer hours within two weeks.</p>
-	<p align="justify">whose usual weekly hours were 40 or less for people aged under 18 years or 48 or less for people aged 18 years and over.</p>

<p align="justify">The official underemployment rate is then calculated as the proportion of underemployed people among the total active population.</p>

<p align="justify">We follow a similar approach by measuring time-related underemployment using three main indicators:</p>
1. <p align="justify">Part-timers who work part-time because they could not find a full-time job.</p>
2. <p align="justify">Workers who would like to work longer hours in their current job.</p>
3. <p align="justify">Workers seeking a replacement job with more hours.</p>

<p align="justify">We do not use the total active population to calculate the underemployment rate, but only those in in employment (employees and self-employed).</p>


## Involuntary part-time

<p align="justify">People in employment can work on a full-time or a part-time basis. A part-time worker is someone who works fewer hours than a full-time worker. In the UK there is no specific number of hours that makes someone full or part-time, and the full-time/part-time threshold is debated, but a full-time worker will usually work 35 hours or more a week [@GOVND]. In the UK Labour Force Survey, the split between full-time and part-time employment is based on respondents’ self-classification [@ONS2023]. The average hours worked by part-timers, for all the periods included in this analysis, is 20 hours.</p>

<p align="justify">Part-time jobs are of lower quality (including being lower paid) than full-time jobs, on the whole, and they bring a range of career penalties [@ILO2013b]. Yet part-time employment is extensive in the UK. There are various reasons for working on a part-time basis. The Labour Force Survey disaggregates part-time employment by reason as follows:</p>

- **those who could not find full-time jobs**
- those who did not want full-time jobs
- those who were ill or were disabled
- those who were students or were at school

<p align="justify">**We focus on those workers who could not find a full-time job** as our first indicator of underemployment.</p>  

### Male and female workers

<p align="justify"> More female workers are employed part-time compared to men in the UK. Figure \@ref(fig:plot-involuntary-part-time-by-sex) shows which of those part-timers could not find a full-time job. In absolute terms, there are more female than male part-timers unable to find full-time work (see bottom figure). However, the percentage of those who could not find a full-time job is much lower (around 10% in most periods) for women than for men (between 20% to 40%) (top figure). When asked why they work part-time, most female part-timers say they do not want a full-time job, while most male workers want one but cannot find it. A main reason for this difference is that women work part-time to fit around other roles in their lives, including caring for children and others.</p>

```{r involuntary-part-time-by-sex-table, include=FALSE}

options(digits = 3)

t_ptime <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(FTPTWK == 2) %>% # only part-timers
  group_by(year, sequence, quarter, SEX, YPTJOB) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, SEX) %>% # calculate % per group
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(YPTJOB == 3) %>% # could not find full time only
  as_label(.)


```

```{r plot-involuntary-part-time-by-sex, fig.width = 8, fig.asp = 0.7, out.width = '100%', fig.cap= "Part-time workers who could not find a full-time job"}

p_ptime <- t_ptime %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(SEX))) + 
  geom_line(size = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "gray80") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "gray80") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "gray80") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "gray80") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "gray80") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "gray80") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "gray80") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "gray80") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "gray80") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "gray80") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "gray80") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "gray80") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "gray80") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "gray80") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "gray80") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "gray80") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "top",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
    # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Could not find a full-time job as a percentage of all part-time workers in the group")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.75, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.75, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .6) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.75, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .6) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.75, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .6) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 0, margin = ggplot2::margin(0, 0, 0, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(4, 0, 5, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "none", 
        legend.title = element_blank(),
        legend.text = element_text(size = 14),
        panel.spacing = unit(.2, "cm"),
        #legend.key.size = unit(0.5, 'cm'),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 5)))


p_ptime_total <- t_ptime %>% 
  ggplot() + 
  geom_bar(aes(x = sequence, y = count, fill = factor(SEX)), stat="identity", position = "dodge", width=0.8) +  
  geom_vline(xintercept = 4.5, color = "gray80") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "gray80") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "gray80") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "gray80") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "gray80") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "gray80") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "gray80") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "gray80") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "gray80") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "gray80") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "gray80") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "gray80") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "gray80") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "gray80") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "gray80") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "gray80") + # gridline 2021

  # scale and colour
  scale_fill_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,1200000, 100000), limits = c(0, 1200000), labels = comma, expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68),
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "Year", 
       y = "Total", 
       #title ="",
       #subtitle  = "",
       #caption = c("Source: The Underemployment Project. Read more at underemployment.info")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1200000, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 1000000, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1200000, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 1000000, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1200000, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 1000000, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1200000, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 1000000, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 0, margin = ggplot2::margin(0, 0, 0, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 0, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 14),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 5)))

p_ptime / p_ptime_total

```


### Workers by age group

<p align="justify">Figure \@ref(fig:plot-involuntary-part-time-age) show the workers who could not find full-time work divided by age groups. Those part-timers aged between 18 to 24 years old were most likely to find themselves involuntarily working part-time. Time-underemployment among the young intensified after economic recessions (in 2008-9 and 2020) but the cost of living crisis from 2021 onwards has not yet significantly worsened involuntary part-time for younger workers. Trends over time are similar for the other age groups but with significantly lower levels of involuntary part-time.</p>

```{r involuntary-part-time-by-age-table, include=FALSE}

options(digits = 3)

t_ptime_age <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  #creating age categories
  mutate(AGE_cat = case_when(AGE %in% 18:24 ~ "Aged 18 to 24",
                             AGE %in% 25:34 ~ "Aged 25 to 34",
                             AGE %in% 35:44 ~ "Aged 35 to 44",
                             AGE %in% 45:54 ~ "Aged 45 to 54",
                             AGE %in% 55:64 ~ "Aged 55 to 64",
                             is.na(AGE) ~ NA)) %>%
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  group_by(year, sequence, quarter, AGE_cat, YPTJOB) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, AGE_cat) %>% # calculate % per group
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(YPTJOB == 3) %>%  
  as_label(.)

```


```{r plot-involuntary-part-time-age, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, out.width = '100%', fig.cap= "Young workers struggle the most to find full-time jobs"}

p_ptime_age  <- t_ptime_age  %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(AGE_cat))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,0.25, 0.025), limits = c(0, 0.25), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = "Note: Could not find a full-time job as a percentage of all part-time workers in the age group"
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.25, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.20, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.25, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.20, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.25, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.20, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=0.25, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.20, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_ptime_age

```


### Ethnicity

<p align="justify">Work-time in the UK is known to be shaped by ethnic background, with Figure \@ref(fig:plot-involuntary-part-time-ethnicity) showing workers from a minority-ethnic group to have a higher proportion of employees under involuntary part time than white groups. In addition, during this period both groups experienced similar trends by both having an increase after recessions and decreases after economic recoveries. However, this figure highlights that minority-ethnic groups were affected more during recessions, experiencing a larger increase of involuntary workers than white groups after each economic crisis.</p>

```{r involuntary-part-time-by-ethnicity-table, include=FALSE}

LFS_clean <- LFS_clean %>% mutate(ETH2 = case_match(ETH, 
                                        1 ~ "White",
                                        2 ~ "Minority-ethnic", 
                                        3 ~ "Minority-ethnic", 
                                        4 ~ "Minority-ethnic", 
                                        5 ~ "Minority-ethnic",
                                        6 ~ "Minority-ethnic")) %>% 
                                    as_numeric(., keep.labels = TRUE)

t_ptime_eth <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  group_by(year, sequence, quarter, ETH2, YPTJOB) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, ETH2) %>% 
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(YPTJOB == 3) %>%  
  filter(!is.na(ETH2)) %>%  # remove NAs from the ethnicity variable
  as_label(.)


```

```{r plot-involuntary-part-time-ethnicity, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, out.width = '100%', fig.cap= "Ethnic-minority groups more likely to find themselves in involuntary part-time"}

p_ptime_eth  <- t_ptime_eth  %>% 
  ggplot(aes(x = sequence, y = percentage, colour = ETH2)) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021
  #facet_wrap(vars(SEX), nrow = 2) +

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,0.30, 0.025), limits = c(0, 0.30), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="Ethnic-minority groups more likely to find themselves in involuntary part-time",
       #subtitle  = "",
       caption = "Note: Could not find a full-time job as a percentage of all part-time workers in the ethnic group"
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.30, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.25, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.30, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.25, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.30, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.25, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=.30, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.25, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06),
        legend.spacing = unit(0.2, 'cm')) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_ptime_eth

```


### Qualification level

<p align="justify">Qualification levels are a key factor shaping who is time-related underemployed. Figure \@ref(fig:plot-involuntary-part-time-education) shows, across the full years of our analysis, that workers with no qualification or lower-level qualifications find it more difficult to find full-time employment than do those with higher qualifications.</p>

```{r involuntary-part-time-table-education, include=FALSE}

options(digits = 3)

t_ptime_quali <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(FTPTWK == 2) %>% # only part-timers
  group_by(year, sequence, quarter, quali, YPTJOB) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, quali) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(YPTJOB %in% c("3") & !is.na(quali) & !quali %in% c("7")) %>% # could not find
  filter(YPTJOB == 3) %>% # could not find  
  as_label(.)


```

```{r plot-involuntary-part-time-education, fig.width = 7.5, fig.asp = 0.6, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Workers with no formal qualification find it difficult to find full-time work"}

p_ptime_quali <- t_ptime_quali %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(quali))) + 
  geom_line(size = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title =" ",
       #subtitle  = "",
       caption = c("Note: Could not find a full-time job as a percentage of part-time workers in the category")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.80, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.80, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.80, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.80, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
 guides(col = guide_legend(nrow = 2, byrow = TRUE, override.aes = list(size = 6)))

p_ptime_quali

```


### Occupational group 

<p align="justify">Part-time workers are known to be over concentrated in lower waged occupations, and there are far fewer opportunities to work part-time in more senior posts. Figure \@ref(fig:plot-involuntary-part-time-nsec) shows which jobs feature the most involuntary part-time workers. Routine occupations (e.g., HGV driver, van driver, cleaner, porter, packer, sewing machinist, messenger, waiter or waitress, or bar staff), semi-routine (e.g., postal worker, machine operative, security guard, caretaker, farm worker, catering assistant, receptionist or sales assistant) and lower supervisory/technical (e.g., motor mechanic, fitter, inspector, plumber, printer, tool maker, electrician, gardener or train driver) stand apart from manager/professionals and those in intermediate roles for having higher levels of temporal underemployment. Economic downturns affected these groups the most too, intensifying their underemployment.</p>

```{r involuntary-part-time-table-NSEC, include=FALSE}

options(digits = 3)

t_ptime_nsec <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(FTPTWK == 2) %>% # only part-timers
  group_by(year, sequence, quarter, NSEC2, YPTJOB) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, NSEC2) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(NSEC2) & !NSEC2 %in% c(3,6)) %>%  # omit no answers and no apply
  filter(YPTJOB == 3) %>% # could not find  
  as_label(.)

```


```{r plot-involuntary-part-time-nsec, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Routine, semi-routine and technical jobs more likely to be in involuntary part-time "}

p_ptime_nsec <- t_ptime_nsec %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(NSEC2))) + 
  geom_line(size = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dynamic") +
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Could not find a full-time job as a percentage of part-time workers in the category")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.80, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.80, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.80, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.80, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_ptime_nsec


```


###  Zero hours contract

<p align="justify"> The UK has seen a decline in recent years in the number of employees with a so-called standard employment relationship, in which they have a secure and full-time job contract with their employer. The expansion in alternate contract types (e.g. flexi work, term-time working) raises many questions about the quality of that work and workers’ experiences. Perhaps the most contentious form of work, especially relevant for our focus on temporal underemployment, is the zero-hours contract, in which workers are not guaranteed any hours of work at all from their employer. Zero hours contracts give employers a great deal of flexibility, but there is debate over whether workers opt positively into zero hours jobs for flexibility themselves or have to agree to such precarious work in a tight labour market. We show here that part-timers with more precarious contracts are more likely to be in part-time work because they could not find a full-time job (Figure \@ref(fig:plot-involuntary-part-time-fled) confirms this trend). Workers in zero-hours contracts stand apart.</p>

```{r involuntary-part-time-table-fled, include=FALSE}

# 7 "On call working" is not presente before 2010

# "Flexi-time" = 1,
# "Annualised hours contract" = 2,
# "Term-time working" = 3,
# "Job sharing" = 4,
# "Condensed or compressed hours" = 5,
# "Zero hours contract" = 6, 
# "On call working" = 7,
# "None of these" = 8

options(digits = 3)

t_ptime_fled <- LFS_clean %>% # summary table
  filter(!sequence %in% c(1, 3, 5, 7, 9, 13, 17, 19, 21, 23, 
                        25, 27, 31, 33, 35, 37, 39, 41, 43,
                        45, 47, 49, 51, 53, 55)) %>%
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(FTPTWK == 2) %>% # only part-timers
  group_by(year, sequence, quarter, FLED, YPTJOB) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, FLED) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(FLED) & !FLED %in% c(5, 7, 8)) %>%  # omit compressed, none, and on call
  filter(YPTJOB == 3) %>% # could not find  
  as_label(.)

```

```{r plot-involuntary-part-time-fled, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Workers in zero hours contracts struggle more to find full-time work"}

p_ptime_fled <- t_ptime_fled %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(FLED))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dynamic") +
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","","2006","",
                              "","2007","","",
                              "","2008","","",
                              "","2009","","",
                              "","2010","","",
                              "","2011","","",
                              "","2012","","",
                              "","2013","","",
                              "","2014","","",
                              "","2015","","",
                              "","2016","","",
                              "","2017","","",
                              "","2018","","",
                              "","2019","","",
                              "","2020","","",
                              "","2021","","",
                              "","2022","",""),
                     expand = c(0,0)) +

   # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Could not find a full-time job as a percentage of part-time workers in the category")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.80, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.80, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.80, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.80, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_ptime_fled

```


### Regional trends

<p align="justify">Our project provides analysis of underemployment across the UK, but it focuses too on the four cities of Bristol, Glasgow, Nottingham and Salford. Figure \@ref(fig:plot-involuntary-part-time-region) shows the distribution of workers in involuntary part-time in regions of England and Scotland that are in the scope of this project plus the rest of England. The North West of England (which includes Salford) and Scotland (including Glasgow) have the largest proportion of workers working part-time because they could not find a full-time work, with the South West (including Bristol) the least, persisting over time. Meanwhile, the East Midlands Region (including Nottingham) saw an increase during 2022.</p>
 
 
```{r involuntary-parttime-region, include=FALSE}

LFS_clean <- LFS_clean %>% mutate(GOVTOF3 = case_match(GOVTOF2, 
                                            1 ~ "Rest of England",
                                            2 ~ "North West", 
                                            4 ~ "Rest of England",
                                            5 ~ "East Midlands", 
                                            6 ~ "Rest of England", 
                                            7 ~ "Rest of England",
                                            8 ~ "Rest of England", 
                                            9 ~ "Rest of England",
                                            10 ~ "South West",
                                            11 ~ "Wales",
                                            12 ~ "Scotland",
                                            13 ~ "Northern Ireland")) %>% 
                                                as_numeric(., keep.labels = TRUE)

LFS_clean$GOVTOF3 <- set_labels(LFS_clean$GOVTOF3, labels = c(
                                                      "East Midlands (incl. Nottingham)" = 1,
                                                      "North West (incl. Salford)" = 2, 
                                                      "Northern Ireland" = 3,
                                                      "Rest of England" = 4, 
                                                      "Scotland (incl. Glasgow)" = 5, 
                                                      "South West (incl. Bristol)" = 6,
                                                      "Wales" = 7))

options(digits = 2)

t_ptime_region <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(FTPTWK == 2) %>% # only part-timer
  group_by(year, sequence, quarter, GOVTOF3, YPTJOB) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, GOVTOF3) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(GOVTOF3)) %>%  # omit no answers and no apply
  filter(YPTJOB == 3) %>% # could not find  
  select(!YPTJOB) %>% 
  as_label(.)

```


```{r plot-involuntary-part-time-region, fig.width = 7.5, fig.asp = 0.6, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Workers in the North West of England and Scotland struggle more to find full-time work"}

p_ptime_region <- t_ptime_region %>% 
  filter(!GOVTOF3 %in% c("Northern Ireland","Wales")) %>% 
  ggplot(aes(x = sequence, y = percentage, col = factor(GOVTOF3))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dynamic") +
  scale_y_continuous(breaks = seq(0,0.5, 0.05), limits = c(0, 0.5), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Could not find a full-time job as a percentage of part-time workers in the region")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.5, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.42, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.5, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.42, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.42, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.42, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 0, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 2, byrow = TRUE, override.aes = list(size = 6)))

p_ptime_region

```


### Industry trends

<p align="justify">In addition to its concern with underemployment across the whole labour force in the UK, the project focuses upon two industry sectors: Wholesale and retail trade, and Human health and social work. We are examining the extent of diverse and intersecting forms of underemployment there and the lived experiences of workers. Figure \@ref(fig:plot-involuntary-part-time-ind1) shows the distribution of workers in involuntary part-time in six sectors related with the provision of services. Involuntary part-time is particularly concentrated in the Retail as well as Hospitality (accommodation and food service) sectors, consistent over time. Human health and social work activities show lower levels compared to the two sectors mentioned above, and similar rates with sectors such as Education.</p>

```{r involuntary-part-time-table-ind1, include=FALSE}

options(digits = 3)

t_ptime_ind1 <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(FTPTWK == 2) %>% # only part-timers
  group_by(year, sequence, quarter, ind1, YPTJOB) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, ind1) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(ind1) & ind1 %in% c(7, 17, 11, 16, 10, 9)) %>%  # omit no answers and no apply
  filter(YPTJOB == 3) %>% # could not find  
  as_label(.)

# Of interest:
  # "Wholesale and retail trade" = 7,
  # "Human health and social work" = 17

```


```{r plot-involuntary-part-time-ind1, fig.width = 7.5, fig.asp = 0.6, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Involuntary part-time is concentrated in the Retail and Hospitality sectors"}

p_ptime_ind1 <- t_ptime_ind1 %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(ind1))) + 
  geom_line(size = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Could not find a full-time job as a percentage of part-time workers in the category")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.80, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.80, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.80, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.80, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 3, byrow = TRUE, override.aes = list(size = 5)))

p_ptime_ind1

```


## Wanting longer hours

<p align="justify"> Our second indicator of time-related underemployment moves beyond the focus only on part-time workers. We explore next all workers who say that they would like to work longer hours in their jobs (at their current basic rate of pay). The following sections look at this group of workers by gender, age, ethnicity and so on.</p>

### Male and female workers

<p align="justify"> Indicator 1 of temporal underemployment (involuntary part-timers) showed greater numbers of women impacted, but higher rates among male part-time workers. Figure \@ref(fig:plot-longer-hours-sex) shows the rate and number of workers wishing to work longer hours in their current jobs. Female workers are slightly more likely than are men to say they want more hours. The trends over time follow a similar pattern for male and female workers characterised by periods of increased underemployment during and after economic recessions.</p>

```{r longer-hours-gender-table, include=FALSE}

options(digits = 3)

t_undemp_sex <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 2) %>% # Applies to all respondents who are not looking for a different or additional job
  group_by(year, sequence, quarter, SEX, UNDEMP) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, SEX) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(UNDEMP)) %>% # remove NAs. Only responses to the question
  filter(UNDEMP == 1) %>% # only those wating to work additional hours
  as_label(.)


```


```{r plot-longer-hours-sex, ffig.width = 8, fig.asp = 0.8, out.width = '100%', fig.cap= "Women slightly more represented among workers wanting more hours"}

p_undemp_sex_rate <- t_undemp_sex %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(SEX))) + 
  geom_line(size = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "gray80") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "gray80") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "gray80") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "gray80") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "gray80") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "gray80") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "gray80") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "gray80") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "gray80") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "gray80") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "gray80") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "gray80") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "gray80") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "gray80") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "gray80") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "gray80") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,0.3, 0.025), limits = c(0, 0.3), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "top",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
    # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       #caption = c("")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.3, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.27, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.3, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.27, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .6) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.3, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.27, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .6) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=0.3, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.27, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .6) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0.4, 0), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 0, margin = ggplot2::margin(0, 0, 0, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(4, 0, 5, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "none", 
        legend.title = element_blank(),
        legend.text = element_text(size = 14),
        panel.spacing = unit(.2, "cm"),
        #legend.key.size = unit(0.5, 'cm'),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 5)))


p_undemp_sex_total <- t_undemp_sex %>% 
  ggplot() + 
  geom_bar(aes(x = sequence, y = count, fill = factor(SEX)), stat="identity", position = "dodge", width=0.8) +  
  geom_vline(xintercept = 4.5, color = "gray80") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "gray80") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "gray80") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "gray80") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "gray80") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "gray80") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "gray80") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "gray80") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "gray80") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "gray80") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "gray80") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "gray80") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "gray80") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "gray80") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "gray80") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "gray80") + # gridline 2021

  # scale and colour
  scale_fill_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,3000000, 300000), limits = c(0, 3000000), labels = comma, expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68),
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "Year", 
       y = "Total", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Applies to all respondents who are not looking for a different or additional job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=3000000, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 2550000, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=3000000, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 2550000, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=3000000, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 2550000, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=3000000, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 2550000, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0.4, 0), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 0, margin = ggplot2::margin(0, 0, 0, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 0, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 14),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_undemp_sex_rate / p_undemp_sex_total

```


### Workers by age group

<p align="justify">The second indicator of underemployment adds support to our earlier finding of higher levels of underemployment among younger workers. Figure \@ref(fig:plot-longer-hours-age) shows that the younger the worker is, the more likely they are to want longer hours in their current jobs. As with involuntary part-time, this form of underemployment increased after economic recessions, for younger workers especially. </p>

```{r longer-hours-age-table, include=FALSE}

options(digits = 3)

t_undemp_age <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  #creating age categories
  mutate(AGE_cat = case_when(AGE %in% 18:24 ~ "Aged 18 to 24",
                             AGE %in% 25:34 ~ "Aged 25 to 34",
                             AGE %in% 35:44 ~ "Aged 35 to 44",
                             AGE %in% 45:54 ~ "Aged 45 to 54",
                             AGE %in% 55:64 ~ "Aged 55 to 64",
                             is.na(AGE) ~ NA)) %>%
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 2) %>% # Applies to all respondents who are not looking for a different or additional job
  group_by(year, sequence, quarter, AGE_cat, UNDEMP) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, AGE_cat) %>% # calculate % per group
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(UNDEMP)) %>% # remove NAs. Only responses to the question
  filter(UNDEMP == 1) %>% # only those wating to work additional hours
  as_label(.)

```

```{r plot-longer-hours-age, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.cap= "Young workers wish to work more hours"}

p_undemp_age  <- t_undemp_age  %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(AGE_cat))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,0.50, 0.05), limits = c(0, 0.50), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = "Note: Applies to all respondents who are not looking for a different or additional job"
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.5, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.40, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.5, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.40, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.40, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.40, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_undemp_age

```


### Ethnicity

<p align="justify">Figure \@ref(fig:plot-longer-hours-eth) shows preferences for more hours of work by ethnic group. Minority-ethnic workers are again more likely to want more hours, and with unstable trends over time. </p>

```{r longer-hours-eth-table, include=FALSE}

LFS_clean <- LFS_clean %>% mutate(ETH2 = case_match(ETH, 
                                        1 ~ "White",
                                        2 ~ "Minority-ethnic", 
                                        3 ~ "Minority-ethnic", 
                                        4 ~ "Minority-ethnic", 
                                        5 ~ "Minority-ethnic",
                                        6 ~ "Minority-ethnic")) %>% 
                                    as_numeric(., keep.labels = TRUE)

t_undemp_eth <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 2) %>% # Applies to all respondents who are not looking for a different or additional job
  group_by(year, sequence, quarter, ETH2, UNDEMP) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, ETH2) %>% 
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(UNDEMP)) %>% # remove NAs. Only responses to the question
  filter(UNDEMP == 1) %>% # only those wating to work additional hours
  filter(!is.na(ETH2)) %>%  # remove NAs from the ethnicity variable
  as_label(.)

```


```{r plot-longer-hours-eth, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.cap= "Ethnic-minority group are up to two times more likely to wish for more hours of work"}

p_undemp_eth  <- t_undemp_eth  %>% 
  ggplot(aes(x = sequence, y = percentage, colour = ETH2)) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,0.50, 0.05), limits = c(0, 0.50), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = "Note: Applies to all respondents who are not looking for a different or additional job"
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.50, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.35, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.50, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.35, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.50, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.35, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=.50, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.35, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06),
        legend.spacing = unit(0.2, 'cm')) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_undemp_eth

```


### Qualification level

<p align="justify">Figure \@ref(fig:plot-longer-hours-quali) compares preferences for more hours in their current jobs by qualification. Overall, workers with lower level and no qualifications would like to work more hours in their current jobs. Workers with degrees are again the group least likely to be underemployed on this measure.</p>

```{r longer-hours-quali-table, include=FALSE}

t_under_quali <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 2) %>% # Applies to all respondents who are not looking for a different or additional job
  group_by(year, sequence, quarter, quali, UNDEMP) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, quali) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(quali) & !quali %in% c("7")) %>% 
  filter(!is.na(UNDEMP)) %>% # remove NAs. Only responses to the question
  filter(UNDEMP == 1) %>% # only those wating to work additional hours
  as_label(.)

```

```{r plot-longer-hours-quali, fig.width = 7.5, fig.asp = 0.6, out.width = '100%', fig.cap= "The lower the qualification, the more likely to want more hours"}

p_under_quali <- t_under_quali %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(quali))) + 
  geom_line(size = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,0.3, 0.025), limits = c(0, 0.3), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title =" ",
       #subtitle  = "",
       caption = c("Note: Applies to all respondents who are not looking for a different or additional job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.3, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.25, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.3, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.25, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.30, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.25, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=0.30, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.25, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
 guides(col = guide_legend(nrow = 2, byrow = TRUE, override.aes = list(size = 6)))

p_under_quali

```


### Occupational group

<p align="justify"> That the risks of being underemployed are shaped by occupational group is also shown with this second indicator. Workers in routine and semi-routine occupations are more likely to report wanting to work more hours in their current jobs than are other workers (Figure \@ref(fig:plot-longer-hours-time-nsec)), peaking at almost a fifth in 2013 and starting to rise again in 2022 after a post-pandemic dip.</p>

```{r longer-hours-table-NSEC, include=FALSE}

options(digits = 3)

t_under_nsec <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 2) %>% # Applies to all respondents who are not looking for a different or additional job
  group_by(year, sequence, quarter, NSEC2, UNDEMP) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, NSEC2) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(NSEC2) & !NSEC2 %in% c(3,6)) %>%  # omit no answers and no apply
  filter(!is.na(UNDEMP)) %>% # remove NAs. Only responses to the question
  filter(UNDEMP == 1) %>% # only those wanting to work additional hours
  as_label(.)

```


```{r plot-longer-hours-time-nsec, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Routine and semi-routine workers would like to work more hours in their current jobs"}

p_under_nsec <- t_under_nsec %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(NSEC2))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dynamic") +
  scale_y_continuous(breaks = seq(0,0.5, 0.05), limits = c(0, 0.5), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Applies to all respondents who are not looking for a different or additional job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.5, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.40, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.5, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.40, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.40, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.40, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_under_nsec


```


###  Zero hours contracts

<p align="justify"> When we examine who would like to work longer hours in their current jobs, we see again the higher proportions of those on zero hours contracts who are underemployed (Figure \@ref(fig:plot-longer-hours-fled)). This was especially true in the years following the great recession when around a third reported wanting to work more.</p>

```{r longer-hours-table-fled, include=FALSE}

options(digits = 3)

t_under_fled <- LFS_clean %>% # summary table
  filter(!sequence %in% c(1, 3, 5, 7, 9, 13, 17, 19, 21, 23, 
                          25, 27, 31, 33, 35, 37, 39, 41, 43,
                          45, 47, 49, 51, 53, 55)) %>% 
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 2) %>% # Applies to all respondents who are not looking for a different or additional job
  group_by(year, sequence, quarter, FLED, UNDEMP) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, FLED) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(FLED) & !FLED %in% c(5, 7, 8)) %>%  # omit compressed, none, and on call
  filter(!is.na(UNDEMP)) %>% # remove NAs. Only responses to the question
  filter(UNDEMP == 1) %>% # only those wanting to work additional hours
  as_label(.)
  
```

```{r plot-longer-hours-fled, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Workers in zero hours contracts more likely to want more hours of work"}

p_under_fled <- t_under_fled %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(FLED))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dynamic") +
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","","2006","",
                              "","2007","","",
                              "","2008","","",
                              "","2009","","",
                              "","2010","","",
                              "","2011","","",
                              "","2012","","",
                              "","2013","","",
                              "","2014","","",
                              "","2015","","",
                              "","2016","","",
                              "","2017","","",
                              "","2018","","",
                              "","2019","","",
                              "","2020","","",
                              "","2021","","",
                              "","2022","",""),
                     expand = c(0,0)) +

   # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Applies to all respondents who are not looking for a different or additional job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.80, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.80, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.80, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.80, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_under_fled

```


### Part-time and full-time

<p align="justify"> It is expected that those part-time workers who say they work part-time because they could not find full-time jobs would like to work more hours. However, less is known about workers in full-time jobs and those who say they are voluntarily working part-time. Are they fine with their current hours or would they also like more? Figure \@ref(fig:plot-longer-hours-fp-time) shows that a substantial percentage (over 10%) of those part-timers who work part-time because they do not want a full-time job would still like to work more hours. The ‘part-time’ hours band is a wide one, shorter hours part-time jobs are associated with lower quality than longer, and few part-timers have free choice over the number of hours they work.</p>

```{r extra-hours-ptimeftime-table, include=FALSE}

options(digits = 3)

t_undemp_ptime <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 2) %>% # Applies to all respondents who are not looking for a different or additional job
  group_by(year, sequence, quarter, FTPTWK, YPTJOB, UNDEMP) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, FTPTWK, YPTJOB) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(UNDEMP) & !is.na(FTPTWK)) %>% # remove NAs. Only responses to the question
  filter(UNDEMP == 1) %>%
  as_label(.)

t_undemp_ptime <- t_undemp_ptime %>% 
  mutate(YPTJOB = case_when(FTPTWK == "Full-time" ~ "Full-time", TRUE ~  YPTJOB)) %>% 
  filter(YPTJOB %in% c("Full-time", "Could not find full-time job", "Did not want full-time job"))

```

```{r plot-longer-hours-fp-time, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Not only workers in involuntary part-time would like to work more hours"}

p_undemp_rate_ptime <- t_undemp_ptime %>% 
  ggplot() + 
  geom_line(aes(x = sequence, y = percentage, colour = factor(YPTJOB)), size = 0.5, show.legend = FALSE) +  
  geom_point(aes(x = sequence, y = percentage, colour = factor(YPTJOB)), shape = 20, size = 1, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021
  #facet_wrap(. ~ SEX, ncol=1, strip.position = "top") +
  
  # scale and colour
  scale_color_discrete_qualitative(palette = "Harmonic") +
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="Wants to work more hours in current job",
       #subtitle  = "Part-time vs full-time employed and self-employed workers",
       caption = c("Note: Applies to all respondents who are not looking for a different or additional job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.80, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.80, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.80, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.80, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +
  
  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_undemp_rate_ptime

```

<p align="justify"> Knowing whether workers want to work more hours, or not, is a valuable indicator of time-related underemployment. It tells us little; however, about ‘how’ underemployed workers are, the intensity of their underemployment, and how far workers are away from achieving their hours preferences. Figure \@ref(fig:extra-hours-wanted-plot) shows that full and part-time workers differ in the number of extra hours they would like to work. While full-time workers would like between 7 to 10 additional hours a week, those part-timers who could not find full-time would like up to 15 extra hours. Those who did not want full-time work would still like around 10 additional hours, with little change over time. Given that average hours worked by part-timers in the UK is 20 a week, this is evidence of persistent, wide actual/preferred hours gaps and deep time-related underemployment.</p>

```{r table-extra-hours-pftime, include=FALSE}

t_extra_hours <- LFS_clean %>% 
  filter(AGE >= 18 & AGE <= 64) %>%
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 2) %>% # Applies to all respondents who are not looking for a different or additional job
  filter(UNDEMP == 1) %>%
  select(year, sequence, quarter, FTPTWK, YPTJOB, UNDHRS) %>%
  filter(!is.na(UNDHRS)) %>%
  as_label(FTPTWK, YPTJOB) %>%
  mutate(YPTJOB = case_when(FTPTWK == "Full-time" ~ "Full-time", TRUE ~  YPTJOB)) %>% 
  filter(YPTJOB %in% c("Full-time", "Could not find full-time job", "Did not want full-time job")) %>%
  group_by(year, sequence, quarter, YPTJOB) %>%
  summarise(median = median(UNDHRS)) 


```

```{r extra-hours-wanted-plot, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Extra hours wished to work by part-time and full-time workers"}

p_more_hours <- t_extra_hours %>% 
  ggplot(aes(x = sequence, y = median, colour = YPTJOB)) +
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, size = 1, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") + # Pastel 1, Dark 2, Dark 3, Set 2, Set 3, Warm, Cold, Harmonic, Dynamic
  scale_y_continuous(breaks = seq(0,25, 5), limits = c(0, 25), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Hours", 
       #title ="Median extra hours wished to work",
       #subtitle  = "Extra hours for those who could not find a full-time job",
       caption = c("Note: Applies to all respondents who are not looking for a different or additional job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=25, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 22, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=25, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 22, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=25, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 22, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=25, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 22, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +
  
  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_more_hours

```


### Regional trends

<p align="justify">All regions of the UK experienced a similar trend regarding the proportion of workers wanting to work more hours, in which they all tend to slightly increase after economic recessions. Nonetheless, and in contrast to the previous indicator, Figure \@ref(fig:plot-more-hours-region) shows the South West region (including Bristol) with a slightly higher proportion than the other regions, although this trend changed after COVID-19, in which this region is currently one of the regions with the lowest percentage of workers willing to work more hours while the East Midlands (including Nottingham) and rest of England are the highest.</p>
 
```{r more-hours-region, include=FALSE}

LFS_clean <- LFS_clean %>% mutate(GOVTOF3 = case_match(GOVTOF2, 
                                            1 ~ "Rest of England",
                                            2 ~ "North West", 
                                            4 ~ "Rest of England",
                                            5 ~ "East Midlands", 
                                            6 ~ "Rest of England", 
                                            7 ~ "Rest of England",
                                            8 ~ "Rest of England", 
                                            9 ~ "Rest of England",
                                            10 ~ "South West",
                                            11 ~ "Wales",
                                            12 ~ "Scotland",
                                            13 ~ "Northern Ireland")) %>% 
                                                as_numeric(., keep.labels = TRUE)

LFS_clean$GOVTOF3 <- set_labels(LFS_clean$GOVTOF3, labels = c(
                                                      "East Midlands (incl. Nottingham)" = 1,
                                                      "North West (incl. Salford)" = 2, 
                                                      "Northern Ireland" = 3,
                                                      "Rest of England" = 4, 
                                                      "Scotland (incl. Glasgow)" = 5, 
                                                      "South West (incl. Bristol)" = 6,
                                                      "Wales" = 7))

options(digits = 2)

t_undemp_region <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 2) %>% # Applies to all respondents who are not looking for a different or additional job
  group_by(year, sequence, quarter, GOVTOF3, UNDEMP) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, GOVTOF3) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(GOVTOF3)) %>%  # omit no answers and no apply
  filter(!is.na(UNDEMP)) %>% # remove NAs. Only responses to the question
  filter(UNDEMP == 1) %>% # only those wating to work additional hours
  as_label(.)

```


```{r plot-more-hours-region, fig.width = 7, fig.asp = 0.6, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Slight increase in workers wanting extra hours after economic recessions and in all regions"}

p_undemp_region <- t_undemp_region %>% 
  filter(!GOVTOF3 %in% c("Northern Ireland","Wales")) %>% 
  ggplot(aes(x = sequence, y = percentage, col = factor(GOVTOF3))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dynamic") +
  scale_y_continuous(breaks = seq(0,0.5, 0.05), limits = c(0, 0.5), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Applies to all respondents who are not looking for a different or additional job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.5, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.42, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.5, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.42, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.42, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.42, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 2, byrow = TRUE, override.aes = list(size = 6)))

p_undemp_region

```


### Industry trends

<p align="justify"> Similarly than in the involuntary part-time indicator, Figure \@ref(fig:plot-more-hours-ind1) shows that the two sectors this project focuses on (Hospitality and Retail), followed by Education, are the activities with the highest proportion of workers wishing to work longer hours. On the other hand, the financial and information sectors have remained steadily low and only experienced an increase during the cost-of-living crisis.</p>

```{r more-hours-table-ind1, include=FALSE}

options(digits = 3)

t_undemp_ind1 <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 2) %>% # Applies to all respondents who are not looking for a different or additional job
  group_by(year, sequence, quarter, ind1, UNDEMP) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, ind1) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(ind1) & ind1 %in% c(7, 17, 11, 16, 10, 9)) %>%  # omit no answers and no apply
  filter(!is.na(UNDEMP)) %>% # remove NAs. Only responses to the question
  filter(UNDEMP == 1) %>% # only those wating to work additional hours
  as_label(.)

# Of interest:
  # "Wholesale and retail trade" = 7,
  # "Human health and social work" = 17

```


```{r plot-more-hours-ind1, fig.width = 7.5, fig.asp = 0.6, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Involuntary part-time is concentrated in the Retail and Hospitality sectors"}

p_undemp_ind1 <- t_undemp_ind1 %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(ind1))) + 
  geom_line(size = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,0.5, 0.05), limits = c(0, 0.5), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Applies to all respondents who are not looking for a different or additional job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=0.5, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.46, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=0.5, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.46, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.46, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=0.5, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.46, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 3, byrow = TRUE, override.aes = list(size = 6)))

p_undemp_ind1

```


## Seeking a replacement job

<p align="justify"> The last time-related underemployment indicator we use in this report identifies those workers who are looking for a replacement job. For this, the Labour Force Survey asks participant whether they are looking for a different or additional paid job. If they answer yes, they are asked to clarify if it is an additional job or a replacement job. According to the definition of time-related underemployment, in this case we only consider those who are looking to replace their current job.</p>

### Male and female workers

<p align="justify"> Figure \@ref(fig:plot-seeking-job-sex) shows that between the period of 2006 to 2022 more male workers than female workers have sought a replacement job, although such difference has reduced since the start of the cost of living crisis. Nonetheless, it is important to note this difference can be explained by the higher participation of men in the labour market compared to women.</p>

```{r table-seeking-job-sex, include=FALSE}

#DIFJOB - Whether looking for different or additional paid job or business = (1) Yes
# ADDJOB - Whether seeking replacement or additional job = (1) A new job to replace your present (main) job

t_seeking <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 1) %>% # Whether looking for different or additional paid job or business = (1) Yes
  group_by(year, sequence, quarter, SEX, ADDJOB) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, SEX) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(ADDJOB)) %>%
  filter(ADDJOB == 1) %>% # Whether seeking replacement or additional job = (1) A new job to replace your present (main) job
  as_label(.)

```

```{r plot-seeking-job-sex, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.cap= "More male than female workers are seeking a replacement job"}

p_seeking_total <- t_seeking %>% 
  ggplot() + 
  geom_bar(aes(x = sequence, y = count, fill = SEX), stat="identity", position = "dodge", width=0.8) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_fill_discrete_qualitative(palette = "Dark 3") +
  scale_y_continuous(breaks = seq(0,1500000, 250000), limits = c(0, 1500000), labels = comma, expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom", 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "Year", 
       y = "Total", 
       #title ="Seeking replacement job",
       #subtitle  = "T ",
       caption = c("Note: Applies to all workers seeking a new job to replace their present (main) job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1500000, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 1300000, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1500000, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 1300000, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1500000, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 1300000, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1500000, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 1300000, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +
  
  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(2, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
 guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_seeking_total

```


<p align="justify">Among those looking to change their job, and independently of their gender, between 15% to 20% would like to work longer hours in their new job. In addition, the percentage of employees in this situation increased after the great recession. However, since 2020 this trend has reverted, which could be linked to developments such as the UK pilot experience of reducing the work week to four days, as shown in 
 Figure \@ref(fig:preferred-hours-replacement-job-sex).</p>

```{r preferred-job-hours-in-new-job-sex, include=FALSE}

t_seeking_hours <- LFS_clean %>% 
  filter(AGE >= 18 & AGE <= 64) %>%
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 1) %>%
  filter(ADDJOB == 1) %>%
  group_by(year, sequence, quarter, PREFHR) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(PREFHR) & PREFHR %in% c("1", "2", "3")) %>% 
  as_label(.)

```


```{r preferred-hours-replacement-job-sex, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Preferred working hours in the job being looked for"}

p_seeking_hours <- t_seeking_hours %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(PREFHR))) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, size = 1, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021
  
  # scale and colour
  scale_color_discrete_qualitative(palette = "Set 2") + # Pastel 1, Dark 2, Dark 3, Set 2, Set 3, Warm, Cold, Harmonic, Dynamic
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="Preferred working hours in new job being looked for",
       #subtitle  = " ",
       caption = c("Note: Applies to all workers seeking a new job to replace their present (main) job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.8, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.8, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.8, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = .8, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +
  
  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(2, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
 guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_seeking_hours

```


### Workers by age group

<p align="justify">Considering the trends in the three indicators of time-related underemployment, younger workers could be considered more at risk of falling under this category than older workers. Specifically, Figure \@ref(fig:plot-seeking-by-age) shows that the majority of workers looking to replace their jobs belongs are between 25 and 34 years old, followed by those between 18 to 24 years old.</p>

```{r seeking-by-age-table, include=FALSE}

options(digits = 3)

t_seeking_age <- LFS_clean %>% # summary table
  filter(AGE >= 18 & AGE <= 64) %>% 
  #creating age categories
  mutate(AGE_cat = case_when(AGE %in% 18:24 ~ "Aged 18 to 24",
                             AGE %in% 25:34 ~ "Aged 25 to 34",
                             AGE %in% 35:44 ~ "Aged 35 to 44",
                             AGE %in% 45:54 ~ "Aged 45 to 54",
                             AGE %in% 55:64 ~ "Aged 55 to 64",
                             is.na(AGE) ~ NA)) %>%
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 1) %>% # Whether looking for different or additional paid job or business = (1) Yes
  group_by(year, sequence, quarter, AGE_cat, ADDJOB) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, AGE_cat) %>% # calculate % per group
  # percentage per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(ADDJOB)) %>%
  filter(ADDJOB == 1) %>% # Whether seeking replacement or additional job = (1) A new job to replace your present (main) job
  as_label(.)

```


```{r plot-seeking-by-age, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, out.width = '100%', fig.cap= "Younger workers are more likely to look for a replacement job"}

p_seeking_age  <- t_seeking_age  %>% 
  ggplot(aes(x = sequence, y = count, fill = AGE_cat)) + 
  geom_bar(stat="identity", position = "stack", width=0.9) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_fill_discrete_qualitative(palette = "Dynamic") +
  scale_y_continuous(breaks = seq(0,3000000, 200000), limits = c(0, 3000000), labels = comma, expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom", 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Total", 
       #title ="Seeking replacement job",
       #subtitle  = " ",
       caption = c("Note: Applies to all workers seeking a new job to replace their present (main) job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=3000000, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 2500000, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=3000000, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 2500000, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=3000000, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 2500000, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=3000000, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 2500000, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +
  
  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(2, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
 guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_seeking_age

```


<p align="justify"> Furthermore, as shown in Figure \@ref(fig:preferred-hours-replacement-job-age) the group with the highest proportion of workers seeking to replace their jobs with one that has longer hours is concentrated among those between 18 and 24 years old.</p>

```{r preferred-job-hours-in-new-job-age, include=FALSE}

t_seeking_hours_age <- LFS_clean %>% 
  filter(AGE >= 18 & AGE <= 64) %>%
  #creating age categories
  mutate(AGE_cat = case_when(AGE %in% 18:24 ~ "Aged 18 to 24",
                             AGE %in% 25:34 ~ "Aged 25 to 34",
                             AGE %in% 35:44 ~ "Aged 35 to 44",
                             AGE %in% 45:54 ~ "Aged 45 to 54",
                             AGE %in% 55:64 ~ "Aged 55 to 64",
                             is.na(AGE) ~ NA)) %>%
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 1) %>%
  filter(ADDJOB == 1) %>%
  group_by(year, sequence, quarter, AGE_cat, PREFHR) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, AGE_cat) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(PREFHR) & PREFHR == 1) %>% 
  as_label(.)

```


```{r preferred-hours-replacement-job-age, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Workers between 18 to 24 years old looking for a replacement job with longer hours"}

p_seeking_hours_age <- t_seeking_hours_age %>% 
  ggplot(aes(x = sequence, y = percentage, colour = AGE_cat)) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, size = 1, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021
  
  # scale and colour
  scale_color_discrete_qualitative(palette = "Set 2") + # Pastel 1, Dark 2, Dark 3, Set 2, Set 3, Warm, Cold, Harmonic, Dynamic
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="Preferred working hours in new job being looked for",
       #subtitle  = " ",
       caption = c("Note: Applies to all workers seeking a new job to replace their present (main) job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.8, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.8, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.8, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = .8, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +
  
  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(2, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
 guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_seeking_hours_age

```


### Ethnicity

<p align="justify"> As Figure \@ref(fig:plot-preferred-hours-replacement-job-eth) shows, During this period white workers looking to replace their jobs have remained below 20% and relatively stable. On the contrary, throughout most of this period ethnic-minority workers in this situation has remained over 20% and just at the start of the cost of living crisis percentages have dropped to below 20%. </p>

```{r table-preferred-job-hours-in-new-job-eth, include=FALSE}

LFS_clean <- LFS_clean %>% mutate(ETH2 = case_match(ETH, 
                                        1 ~ "White",
                                        2 ~ "Minority-ethnic", 
                                        3 ~ "Minority-ethnic", 
                                        4 ~ "Minority-ethnic", 
                                        5 ~ "Minority-ethnic",
                                        6 ~ "Minority-ethnic")) %>% 
                                    as_numeric(., keep.labels = TRUE)

t_seeking_hours_eth <- LFS_clean %>% 
  filter(AGE >= 18 & AGE <= 64) %>%
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 1) %>%
  filter(ADDJOB == 1) %>%
  group_by(year, sequence, quarter, ETH2, PREFHR) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, ETH2) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(PREFHR) & PREFHR == 1) %>% # only longer hours
  filter(!is.na(ETH2)) %>%  # remove NAs from the ethnicity variable
  as_label(.)

```


```{r plot-preferred-hours-replacement-job-eth, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Ethnic-minority workers more likely to look for replacement jobs with longer hours"}

p_seeking_hours_eth <- t_seeking_hours_eth %>% 
  ggplot(aes(x = sequence, y = percentage, colour = ETH2)) + 
  geom_line(linewidth = 0.7, show.legend = FALSE) +  
  geom_point(shape = 20, size = 1, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021
  
  # scale and colour
  scale_color_discrete_qualitative(palette = "Dark 3") + # Pastel 1, Dark 2, Dark 3, Set 2, Set 3, Warm, Cold, Harmonic, Dynamic
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), position = "bottom",
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="Preferred working hours in new job being looked for",
       #subtitle  = " ",
       caption = c("Note: Applies to all workers seeking a new job to replace their present (main) job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.8, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.8, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.8, label = "Covid-19\nrecession", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = .8, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +
  
  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(2, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 4)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
 guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_seeking_hours_eth

```


### Occupational group

<p align="justify"> Lastly, through Figure \@ref(fig:plot-preferred-job-hours-in-new-job-nsec) is possible to observed that workers in routine and semi-routine occupations are those more interested in replacing their current job. Furthermore, this group is up to three times more likely to look for a replacement job with longer hours compared to management and professional occupations.</p>

```{r table-preferred-job-hours-in-new-job-NSEC, include=FALSE}

options(digits = 3)

t_seeking_hours_nsec <- LFS_clean %>% 
  filter(AGE >= 18 & AGE <= 64) %>%
  filter(ILODEFR == 1) %>% # only people in employment
  filter(INECAC05 %in% c(1, 2)) %>% #only employees and self-employed
  filter(DIFJOB == 1) %>%
  filter(ADDJOB == 1) %>%
  group_by(year, sequence, quarter, NSEC2, PREFHR) %>% 
  summarise(count = sum(PWT)) %>% 
  group_by(year, sequence, quarter, NSEC2) %>% 
  # percentage part-time per quarter
  mutate(percentage = count/sum(count)) %>% 
  filter(!is.na(PREFHR) & PREFHR == 1) %>% # only longer hours
  filter(!is.na(NSEC2) & !NSEC2 %in% c("3","6")) %>%  # omit no answers and no apply
  as_label(.)

```

```{r plot-preferred-job-hours-in-new-job-nsec, fig.width = 7, fig.asp = 0.5, out.width = '100%', fig.fullwidth = TRUE, fig.cap= "Working class workers more likely to seek for a replacement job with longer hours"}

p_seeking_hours_nsec <- t_seeking_hours_nsec %>% 
  ggplot(aes(x = sequence, y = percentage, colour = factor(NSEC2))) + 
  geom_line(size = 0.7, show.legend = FALSE) +  
  geom_point(size = 1, shape = 20, show.legend = TRUE) +
  geom_vline(xintercept = 4.5, color = "#c9c9c9") + # gridline 2006
  geom_vline(xintercept = 8.5, color = "#c9c9c9") + # gridline 2007
  geom_vline(xintercept = 12.5, color = "#c9c9c9") + # gridline 2008
  geom_vline(xintercept = 16.5, color = "#c9c9c9") + # gridline 2009
  geom_vline(xintercept = 20.5, color = "#c9c9c9") + # gridline 2010
  geom_vline(xintercept = 24.5, color = "#c9c9c9") + # gridline 2011
  geom_vline(xintercept = 28.5, color = "#c9c9c9") + # gridline 2012
  geom_vline(xintercept = 32.5, color = "#c9c9c9") + # gridline 2013
  geom_vline(xintercept = 36.5, color = "#c9c9c9") + # gridline 2014
  geom_vline(xintercept = 40.5, color = "#c9c9c9") + # gridline 2015
  geom_vline(xintercept = 44.5, color = "#c9c9c9") + # gridline 2016
  geom_vline(xintercept = 48.5, color = "#c9c9c9") + # gridline 2017
  geom_vline(xintercept = 52.5, color = "#c9c9c9") + # gridline 2018
  geom_vline(xintercept = 56.5, color = "#c9c9c9") + # gridline 2019
  geom_vline(xintercept = 60.5, color = "#c9c9c9") + # gridline 2020
  geom_vline(xintercept = 64.5, color = "#c9c9c9") + # gridline 2021

  # scale and colour
  scale_color_discrete_qualitative(palette = "Dynamic") +
  scale_y_continuous(breaks = seq(0,1, 0.1), limits = c(0, 1), labels =
                       scales::percent_format(accuracy = 1L), expand = c(0,0)) +
  scale_x_continuous(breaks=c(1:68), 
                     labels=c("","2006","", "", "", "2007", "", "", "", "2008", "", "", "", "2009", "", 
                            "", "", "2010", "", "", "", "2011", "", "", "", "2012", "", "", 
                            "", "2013", "", "", "", "2014", "", "", "", "2015", "", "", "", 
                            "2016", "", "", "", "2017", "", "", "", "2018", "", "", "", "2019", "",
                            "", "", "2020", "", "", "", "2021", "", "", "", "2022", "", ""), expand = c(0,0)) +
  # annotation
  labs(x = "", 
       y = "Percentage", 
       #title ="",
       #subtitle  = "",
       caption = c("Note: Applies to all workers seeking a new job to replace their present (main) job")
       ) +
  annotate('rect', xmin=10, xmax=14, ymin=0, ymax=1, alpha=.2, fill='brown1') + # Great Recession
  annotate(geom = "text", x = 10, y = 0.80, label = "Great Recession", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=30.5, xmax=31.5, ymin=0, ymax=1, alpha=.2, fill='darkgreen') + # back to pre-recession
  annotate(geom = "text", x = 31.2, y = 0.80, label = "UK economy gets back\nto pre-downturn size", hjust = 0, size = 5, colour = "darkgreen", lineheight = .7) +
  annotate('rect', xmin=56.5, xmax=58, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 56.5, y = 0.80, label = "Covid-19", hjust = 0, size = 5, colour = "darkred") +
  annotate('rect', xmin=63, xmax=68, ymin=0, ymax=1, alpha=.2, fill='brown1') +
  annotate(geom = "text", x = 63, y = 0.80, label = "Cost of\nliving crisis", hjust = 0, size = 5, colour = "darkred", lineheight = .7) +
  annotation_custom(copyright) +

  # theme
  theme_economist_white(gray_bg = FALSE, base_family = "Lato") +
  theme(plot.margin = unit(c(0, 0, 0, 0.3), "cm"),
        plot.title = element_text(size = 15, margin = ggplot2::margin(0, 0, 0, 0)),
        plot.subtitle = element_text(size = 13, hjust = 1, margin = ggplot2::margin(0, 0, 4, 0), colour = "gray50"),
        plot.caption = element_text(size = 12, hjust = 1, margin = ggplot2::margin(0, 0, 2, 0), colour = "gray50"),
        axis.title.x = element_text(margin = ggplot2::margin(t = 10), size = 13),
        axis.title.y = element_text(margin = ggplot2::margin(r = 5), size = 13),
        axis.text.x = element_text(size = 14, margin = margin(t = 2)),
        axis.text.y = element_text(size = 14),
        axis.text.y.left = element_text(margin = margin(r = 2)),
        axis.ticks.length.x = unit(0.1, "cm"), 
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        panel.spacing = unit(.2, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = .06)) +
  guides(col = guide_legend(nrow = 1, byrow = TRUE, override.aes = list(size = 6)))

p_seeking_hours_nsec

```
